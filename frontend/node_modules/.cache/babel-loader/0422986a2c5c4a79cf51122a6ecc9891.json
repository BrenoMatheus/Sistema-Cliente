{"ast":null,"code":"import _toConsumableArray from\"/home/brenomatheus/Documentos/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/home/brenomatheus/Documentos/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useMemo,useState}from'react';import{Grid,Icon,IconButton,LinearProgress,Pagination,Paper,Table,TableBody,TableCell,TableContainer,TableFooter,TableHead,TableRow}from'@mui/material';import{useNavigate,useSearchParams}from'react-router-dom';import{OrdersService}from'../../../shared/services/api/orders/OrdersService';import{Environment}from'../../../shared/environment';import{useDebounce}from'../../../shared/hooks';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var ListOrdersDashboard=function ListOrdersDashboard(){var _useSearchParams=useSearchParams(),_useSearchParams2=_slicedToArray(_useSearchParams,2),searchParams=_useSearchParams2[0],setSearchParams=_useSearchParams2[1];var _useDebounce=useDebounce(),debounce=_useDebounce.debounce;var navigate=useNavigate();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),rows=_useState2[0],setRows=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),totalCount=_useState6[0],setTotalCount=_useState6[1];var search=useMemo(function(){return searchParams.get('search')||'';},[searchParams]);var page=useMemo(function(){return Number(searchParams.get('page')||'1');},[searchParams]);useEffect(function(){setIsLoading(true);debounce(function(){OrdersService.getAll(page,search).then(function(result){setIsLoading(false);if(result instanceof Error){alert(result.message);}else{setTotalCount(result.totalCount);setRows(result.data);if(rows.filter(function(row){return row.status=true;})){console.log('Aberta');}}});});},[search,page]);var handleDelete=function handleDelete(id){if(confirm('Realmente deseja apagar?')){OrdersService.deleteById(id).then(function(result){if(result instanceof Error){alert(result.message);}else{setRows(function(oldRows){return _toConsumableArray(oldRows.filter(function(oldRow){return oldRow.id!==id;}));});alert('Registro apagado com sucesso!');}});}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Grid,{container:true,item:true,xs:12,marginTop:2,component:Paper,variant:\"outlined\",children:/*#__PURE__*/_jsx(Grid,{item:true,xs:4,marginLeft:2,children:!isLoading&&/*#__PURE__*/_jsxs(\"h4\",{children:[\"Ordens: \",totalCount]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,marginTop:2,children:/*#__PURE__*/_jsx(TableContainer,{component:Paper,variant:\"outlined\",sx:{width:'auto'},children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{width:100,children:\"A\\xE7\\xF5es\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Tipo\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Defeito\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Status\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:rows.map(function(row){return/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsxs(TableCell,{children:[/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:function onClick(){return handleDelete(row.id);},children:/*#__PURE__*/_jsx(Icon,{children:\"delete\"})}),/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:function onClick(){return navigate(\"/orders/detail/\".concat(row.id));},children:/*#__PURE__*/_jsx(Icon,{children:\"edit\"})})]}),/*#__PURE__*/_jsx(TableCell,{children:row.type}),/*#__PURE__*/_jsx(TableCell,{children:row.defect}),/*#__PURE__*/_jsx(TableCell,{children:row.status==true?'Fechada':'Aberta'})]},row.id);})}),totalCount===0&&!isLoading&&/*#__PURE__*/_jsx(\"caption\",{children:Environment.EMPTY_LISTING}),/*#__PURE__*/_jsxs(TableFooter,{children:[isLoading&&/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TableCell,{colSpan:3,children:/*#__PURE__*/_jsx(LinearProgress,{variant:\"indeterminate\"})})}),totalCount>0&&totalCount>Environment.LIMITE_DE_LINHAS&&/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TableCell,{colSpan:3,children:/*#__PURE__*/_jsx(Pagination,{page:page,count:Math.ceil(totalCount/Environment.LIMITE_DE_LINHAS),onChange:function onChange(_,newPage){return setSearchParams({search:search,page:newPage.toString()},{replace:true});}})})})]})]})})})]});};","map":{"version":3,"sources":["/home/brenomatheus/Documentos/frontend/src/pages/dashboard/components/ListOrders.tsx"],"names":["useEffect","useMemo","useState","Grid","Icon","IconButton","LinearProgress","Pagination","Paper","Table","TableBody","TableCell","TableContainer","TableFooter","TableHead","TableRow","useNavigate","useSearchParams","OrdersService","Environment","useDebounce","ListOrdersDashboard","searchParams","setSearchParams","debounce","navigate","rows","setRows","isLoading","setIsLoading","totalCount","setTotalCount","search","get","page","Number","getAll","then","result","Error","alert","message","data","filter","row","status","console","log","handleDelete","id","confirm","deleteById","oldRows","oldRow","width","map","type","defect","EMPTY_LISTING","LIMITE_DE_LINHAS","Math","ceil","_","newPage","toString","replace"],"mappings":"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","sourcesContent":["import { useEffect, useMemo, useState } from 'react';\nimport { Grid, Icon, IconButton, LinearProgress, Pagination, Paper, Table, TableBody, TableCell, TableContainer, TableFooter, TableHead, TableRow } from '@mui/material';\nimport { useNavigate, useSearchParams } from 'react-router-dom';\n\nimport { IListOrders, OrdersService, } from '../../../shared/services/api/orders/OrdersService';\nimport { Environment } from '../../../shared/environment';\nimport { useDebounce } from '../../../shared/hooks';\n\n\nexport const ListOrdersDashboard: React.FC = () => {\n  const [searchParams, setSearchParams] = useSearchParams();\n  const { debounce } = useDebounce();\n  const navigate = useNavigate();\n\n  const [rows, setRows] = useState<IListOrders[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [totalCount, setTotalCount] = useState(0);\n\n\n  const search = useMemo(() => {\n    return searchParams.get('search') || '';\n  }, [searchParams]);\n\n  const page = useMemo(() => {\n    return Number(searchParams.get('page') || '1');\n  }, [searchParams]);\n\n\n  useEffect(() => {\n    setIsLoading(true);\n\n    debounce(() => {\n      OrdersService.getAll(page, search)\n        .then((result) => {\n          setIsLoading(false);\n\n          if (result instanceof Error) {\n            alert(result.message);\n          } else {\n            setTotalCount(result.totalCount);\n            setRows(result.data);\n\n            if (rows.filter((row) => row.status = true)) {\n              console.log('Aberta');\n            }\n\n          }\n        });\n    });\n  }, [search, page]);\n\n  const handleDelete = (id: number) => {\n    if (confirm('Realmente deseja apagar?')) {\n      OrdersService.deleteById(id)\n        .then(result => {\n          if (result instanceof Error) {\n            alert(result.message);\n          } else {\n            setRows(oldRows => [\n              ...oldRows.filter(oldRow => oldRow.id !== id),\n            ]);\n            alert('Registro apagado com sucesso!');\n          }\n        });\n    }\n  };\n\n\n  return (\n    <>\n      <Grid container item xs={12} marginTop={2} component={Paper} variant=\"outlined\" >\n        <Grid item xs={4} marginLeft={2}>\n          {!isLoading && (\n            <h4>Ordens: {totalCount}</h4>\n          )}\n        </Grid>\n      </Grid>\n      <Grid item xs={12} marginTop={2}>\n        <TableContainer component={Paper} variant=\"outlined\" sx={{ width: 'auto' }}>\n          <Table>\n            <TableHead>\n              <TableRow>\n                <TableCell width={100}>Ações</TableCell>\n                <TableCell>Tipo</TableCell>\n                <TableCell>Defeito</TableCell>\n                <TableCell>Status</TableCell>\n              </TableRow>\n            </TableHead>\n            <TableBody>\n              {rows.map(row => (\n                \n                <TableRow key={row.id}>\n                  <TableCell>\n                    <IconButton size=\"small\" onClick={() => handleDelete(row.id)}>\n                      <Icon>delete</Icon>\n                    </IconButton>\n                    <IconButton size=\"small\" onClick={() => navigate(`/orders/detail/${row.id}`)}>\n                      <Icon>edit</Icon>\n                    </IconButton>\n                  </TableCell>\n                  <TableCell>{row.type}</TableCell>\n                  <TableCell>{row.defect}</TableCell>\n                  <TableCell>{row.status == true ? 'Fechada':'Aberta'}</TableCell>\n                </TableRow>\n              )\n              )}\n            </TableBody>\n\n            {totalCount === 0 && !isLoading && (\n              <caption>{Environment.EMPTY_LISTING}</caption>\n            )}\n\n            <TableFooter>\n              {isLoading && (\n                <TableRow>\n                  <TableCell colSpan={3}>\n                    <LinearProgress variant='indeterminate' />\n                  </TableCell>\n                </TableRow>\n              )}\n              {(totalCount > 0 && totalCount > Environment.LIMITE_DE_LINHAS) && (\n                <TableRow>\n                  <TableCell colSpan={3}>\n                    <Pagination\n                      page={page}\n                      count={Math.ceil(totalCount / Environment.LIMITE_DE_LINHAS)}\n                      onChange={(_, newPage) => setSearchParams({ search, page: newPage.toString() }, { replace: true })}\n                    />\n                  </TableCell>\n                </TableRow>\n              )}\n            </TableFooter>\n          </Table>\n        </TableContainer>\n      </Grid>\n    </>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}