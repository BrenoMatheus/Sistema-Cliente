{"ast":null,"code":"import _asyncToGenerator from\"/home/brenomatheus/Documentos/Projeto advocacia/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/brenomatheus/Documentos/Projeto advocacia/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/brenomatheus/Documentos/Projeto advocacia/frontend/node_modules/@babel/runtime/regenerator/index.js\";import{createContext,useCallback,useContext,useEffect,useMemo,useState}from'react';import{AuthService}from'../services/api/auth/AuthService';import{ClientsService}from'../services/api/clients/ClientsService';import{jsx as _jsx}from\"react/jsx-runtime\";var AuthContext=/*#__PURE__*/createContext({});var LOCAL_STORAGE_KEY__ACCESS_TOKEN='APP_ACCESS_TOKEN';export var AuthProvider=function AuthProvider(_ref){var children=_ref.children;var _useState=useState(),_useState2=_slicedToArray(_useState,2),accessToken=_useState2[0],setAccessToken=_useState2[1];useEffect(function(){var accessToken=localStorage.getItem(LOCAL_STORAGE_KEY__ACCESS_TOKEN);if(accessToken){setAccessToken(JSON.parse(accessToken));ClientsService.getAll();}else{setAccessToken(undefined);}},[]);var handleLogin=useCallback(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(email,password){var result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return AuthService.auth(email,password);case 2:result=_context.sent;if(!(result instanceof Error)){_context.next=7;break;}return _context.abrupt(\"return\",result.message);case 7:localStorage.setItem(LOCAL_STORAGE_KEY__ACCESS_TOKEN,JSON.stringify(result.accessToken));setAccessToken(result.accessToken);case 9:case\"end\":return _context.stop();}}},_callee);}));return function(_x,_x2){return _ref2.apply(this,arguments);};}(),[]);var handleLogout=useCallback(function(){localStorage.removeItem(LOCAL_STORAGE_KEY__ACCESS_TOKEN);setAccessToken(undefined);},[]);var isAuthenticated=useMemo(function(){return!!accessToken;},[accessToken]);return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{isAuthenticated:isAuthenticated,login:handleLogin,logout:handleLogout},children:children});};export var useAuthContext=function useAuthContext(){return useContext(AuthContext);};","map":{"version":3,"sources":["/home/brenomatheus/Documentos/Projeto advocacia/frontend/src/shared/contexts/AuthContext.tsx"],"names":["createContext","useCallback","useContext","useEffect","useMemo","useState","AuthService","ClientsService","AuthContext","LOCAL_STORAGE_KEY__ACCESS_TOKEN","AuthProvider","children","accessToken","setAccessToken","localStorage","getItem","JSON","parse","getAll","undefined","handleLogin","email","password","auth","result","Error","message","setItem","stringify","handleLogout","removeItem","isAuthenticated","login","logout","useAuthContext"],"mappings":"6aAAA,OAASA,aAAT,CAAwBC,WAAxB,CAAqCC,UAArC,CAAiDC,SAAjD,CAA4DC,OAA5D,CAAqEC,QAArE,KAAqF,OAArF,CAEA,OAASC,WAAT,KAA4B,kCAA5B,CACA,OAASC,cAAT,KAA+B,wCAA/B,C,2CASA,GAAMC,CAAAA,WAAW,cAAGR,aAAa,CAAC,EAAD,CAAjC,CAEA,GAAMS,CAAAA,+BAA+B,CAAG,kBAAxC,CAKA,MAAO,IAAMC,CAAAA,YAA0C,CAAG,QAA7CA,CAAAA,YAA6C,MAAkB,IAAfC,CAAAA,QAAe,MAAfA,QAAe,CAC1E,cAAsCN,QAAQ,EAA9C,wCAAOO,WAAP,eAAoBC,cAApB,eAEAV,SAAS,CAAC,UAAM,CACd,GAAMS,CAAAA,WAAW,CAAGE,YAAY,CAACC,OAAb,CAAqBN,+BAArB,CAApB,CAEA,GAAIG,WAAJ,CAAiB,CACfC,cAAc,CAACG,IAAI,CAACC,KAAL,CAAWL,WAAX,CAAD,CAAd,CAEAL,cAAc,CAACW,MAAf,GACD,CAJD,IAIO,CACLL,cAAc,CAACM,SAAD,CAAd,CACD,CACF,CAVQ,CAUN,EAVM,CAAT,CAaA,GAAMC,CAAAA,WAAW,CAAGnB,WAAW,2FAAC,iBAAOoB,KAAP,CAAsBC,QAAtB,mJACThB,CAAAA,WAAW,CAACiB,IAAZ,CAAiBF,KAAjB,CAAwBC,QAAxB,CADS,QACxBE,MADwB,oBAE1BA,MAAM,WAAYC,CAAAA,KAFQ,0DAGrBD,MAAM,CAACE,OAHc,SAK5BZ,YAAY,CAACa,OAAb,CAAqBlB,+BAArB,CAAsDO,IAAI,CAACY,SAAL,CAAeJ,MAAM,CAACZ,WAAtB,CAAtD,EACAC,cAAc,CAACW,MAAM,CAACZ,WAAR,CAAd,CAN4B,sDAAD,oEAQ5B,EAR4B,CAA/B,CAUA,GAAMiB,CAAAA,YAAY,CAAG5B,WAAW,CAAC,UAAM,CACrCa,YAAY,CAACgB,UAAb,CAAwBrB,+BAAxB,EACAI,cAAc,CAACM,SAAD,CAAd,CACD,CAH+B,CAG7B,EAH6B,CAAhC,CAKA,GAAMY,CAAAA,eAAe,CAAG3B,OAAO,CAAC,iBAAM,CAAC,CAACQ,WAAR,EAAD,CAAsB,CAACA,WAAD,CAAtB,CAA/B,CAGA,mBACE,KAAC,WAAD,CAAa,QAAb,EAAsB,KAAK,CAAE,CAAEmB,eAAe,CAAfA,eAAF,CAAmBC,KAAK,CAAEZ,WAA1B,CAAuCa,MAAM,CAAEJ,YAA/C,CAA7B,UACGlB,QADH,EADF,CAKD,CAvCM,CAyCP,MAAO,IAAMuB,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,SAAMhC,CAAAA,UAAU,CAACM,WAAD,CAAhB,EAAvB","sourcesContent":["import { createContext, useCallback, useContext, useEffect, useMemo, useState } from 'react';\n\nimport { AuthService } from '../services/api/auth/AuthService';\nimport { ClientsService } from '../services/api/clients/ClientsService';\n\n\ninterface IAuthContextData {\n  logout: () => void;\n  isAuthenticated: boolean;\n  login: (email: string, password: string) => Promise<string | void>;\n}\n\nconst AuthContext = createContext({} as IAuthContextData);\n\nconst LOCAL_STORAGE_KEY__ACCESS_TOKEN = 'APP_ACCESS_TOKEN';\n\ninterface IAuthProviderProps {\n  children: React.ReactNode;\n}\nexport const AuthProvider: React.FC<IAuthProviderProps> = ({ children }) => {\n  const [accessToken, setAccessToken] = useState<string>();\n\n  useEffect(() => {\n    const accessToken = localStorage.getItem(LOCAL_STORAGE_KEY__ACCESS_TOKEN);\n\n    if (accessToken) {\n      setAccessToken(JSON.parse(accessToken));\n\n      ClientsService.getAll();\n    } else {\n      setAccessToken(undefined);\n    }\n  }, []);\n\n\n  const handleLogin = useCallback(async (email: string, password: string) => {\n    const result = await AuthService.auth(email, password);\n    if (result instanceof Error) {\n      return result.message;\n    } else {\n      localStorage.setItem(LOCAL_STORAGE_KEY__ACCESS_TOKEN, JSON.stringify(result.accessToken));\n      setAccessToken(result.accessToken);\n    }\n  }, []);\n\n  const handleLogout = useCallback(() => {\n    localStorage.removeItem(LOCAL_STORAGE_KEY__ACCESS_TOKEN);\n    setAccessToken(undefined);\n  }, []);\n\n  const isAuthenticated = useMemo(() => !!accessToken, [accessToken]);\n\n\n  return (\n    <AuthContext.Provider value={{ isAuthenticated, login: handleLogin, logout: handleLogout }}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuthContext = () => useContext(AuthContext);\n"]},"metadata":{},"sourceType":"module"}