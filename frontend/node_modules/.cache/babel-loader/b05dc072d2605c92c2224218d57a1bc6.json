{"ast":null,"code":"import _objectSpread from\"/home/brenomatheus/Documentos/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/brenomatheus/Documentos/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import{Grid,Icon,IconButton,TextField}from'@mui/material';import{formValidationSchema}from'./DetailItemofLines';import{ItemofLinesService}from'../../../../shared/services/api/itemofLines/ItemofLinesService';import{VForm,useVForm}from'../../../../shared/forms';import{useNavigate}from'react-router-dom';import{AutoCompleteItem}from'./AutoCompleteItem';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var TableList=function TableList(_ref){var data=_ref.data,key=_ref.key,id=_ref.id,handleDelete=_ref.handleDelete;var _useState=useState(data.amount),_useState2=_slicedToArray(_useState,2),changedAmount=_useState2[0],setChangedAmount=_useState2[1];var _useState3=useState(data.total),_useState4=_slicedToArray(_useState3,2),changedTotal=_useState4[0],setChangedTotal=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var _useVForm=useVForm(),formRef=_useVForm.formRef,isSaveAndClose=_useVForm.isSaveAndClose;var navigate=useNavigate();var handleSave=function handleSave(dados){formValidationSchema.validate(dados,{abortEarly:false}).then(function(dadosValidados){setIsLoading(true);if(changedAmount!==dados.amount||changedTotal!==dados.total){ItemofLinesService.updateById(Number(id),_objectSpread(_objectSpread({id:Number(id)},dadosValidados),{},{amount:changedAmount,total:changedTotal})).then(function(result){setIsLoading(false);if(result instanceof Error){alert(result.message);}else{if(isSaveAndClose()){navigate('/orders');}}});}}).catch(function(errors){var _formRef$current;var validationErrors={};errors.inner.forEach(function(error){if(!error.path)return;validationErrors[error.path]=error.message;});(_formRef$current=formRef.current)===null||_formRef$current===void 0?void 0:_formRef$current.setErrors(validationErrors);});};return/*#__PURE__*/_jsx(VForm,{ref:formRef,onSubmit:handleSave,children:/*#__PURE__*/_jsxs(Grid,{container:true,direction:\"row\",justifyContent:\"space-between\",alignItems:\"center\",borderBottom:1,spacing:{xs:0,md:0},columns:{xs:3,sm:6,md:8},children:[/*#__PURE__*/_jsx(Grid,{item:true,spacing:0,margin:0,padding:0,children:/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:function onClick(){return handleDelete(data.id);},children:/*#__PURE__*/_jsx(Icon,{children:\"delete\"})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:2,sm:4,md:3,children:/*#__PURE__*/_jsx(AutoCompleteItem,{isExternalLoading:isLoading,itemID:data.itemID})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:2,sm:4,md:2,children:/*#__PURE__*/_jsx(TextField,{variant:\"standard\",defaultValue:data.amount,onChange:function onChange(e){return setChangedAmount(Number(e.target.value));},onBlur:function onBlur(){return handleSave(data);}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:2,sm:4,md:2,children:/*#__PURE__*/_jsx(TextField,{variant:\"standard\",defaultValue:data.total,onChange:function onChange(e){return setChangedTotal(Number(e.target.value));},onBlur:function onBlur(){return handleSave(data);}})})]})},key);};export default TableList;","map":{"version":3,"sources":["/home/brenomatheus/Documentos/frontend/src/pages/orders/components/itemofLines/TableList.tsx"],"names":["React","useState","Grid","Icon","IconButton","TextField","formValidationSchema","ItemofLinesService","VForm","useVForm","useNavigate","AutoCompleteItem","TableList","data","key","id","handleDelete","amount","changedAmount","setChangedAmount","total","changedTotal","setChangedTotal","isLoading","setIsLoading","formRef","isSaveAndClose","navigate","handleSave","dados","validate","abortEarly","then","dadosValidados","updateById","Number","result","Error","alert","message","catch","errors","validationErrors","inner","forEach","error","path","current","setErrors","xs","md","sm","itemID","e","target","value"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\n\nimport { Grid, Icon, IconButton, TextField } from '@mui/material';\nimport * as yup from 'yup';\nimport { formValidationSchema } from './DetailItemofLines';\nimport {\n  IListItemofLine,\n  ItemofLinesService,\n} from '../../../../shared/services/api/itemofLines/ItemofLinesService';\nimport { IVFormErrors, VForm, useVForm } from '../../../../shared/forms';\nimport { useNavigate } from 'react-router-dom';\nimport { AutoCompleteItem } from './AutoCompleteItem';\n\ntype TVTextFieldProps = {\n  name: string;\n  data: IListItemofLine;\n  key: number;\n  id: number;\n  handleDelete:any;\n};\n\nexport interface IFormData {\n  orderID: number;\n  itemID: number;\n  amount: number;\n  total: number;\n}\n\nexport const TableList: React.FC<TVTextFieldProps> = ({ data, key, id, handleDelete }) => {\n  const [changedAmount, setChangedAmount] = useState(data.amount);\n  const [changedTotal, setChangedTotal] = useState(data.total);\n  const [isLoading, setIsLoading] = useState(false);\n  const { formRef, isSaveAndClose } = useVForm();\n  const navigate = useNavigate();\n\n  const handleSave = (dados: IFormData) => {\n    formValidationSchema\n      .validate(dados, { abortEarly: false })\n      .then((dadosValidados) => {\n        setIsLoading(true);\n        if (changedAmount !== dados.amount || changedTotal !== dados.total) {\n          ItemofLinesService.updateById(Number(id), {\n            id: Number(id),\n            ...dadosValidados,\n            amount: changedAmount,\n            total: changedTotal,\n          }).then((result) => {\n            setIsLoading(false);\n\n            if (result instanceof Error) {\n              alert(result.message);\n            } else {\n              if (isSaveAndClose()) {\n                navigate('/orders');\n              }\n            }\n          });\n        }\n      })\n      .catch((errors: yup.ValidationError) => {\n        const validationErrors: IVFormErrors = {};\n\n        errors.inner.forEach((error) => {\n          if (!error.path) return;\n\n          validationErrors[error.path] = error.message;\n        });\n\n        formRef.current?.setErrors(validationErrors);\n      });\n  };\n\n  return (\n    <VForm key={key} ref={formRef} onSubmit={handleSave}>\n      <Grid\n        container\n        direction=\"row\"\n        justifyContent=\"space-between\"\n        alignItems=\"center\"\n        borderBottom={1}\n        spacing={{ xs: 0, md: 0 }}\n        columns={{ xs: 3, sm: 6, md: 8 }}\n      >\n        <Grid item spacing={0} margin={0} padding={0}>\n          <IconButton size=\"small\" onClick={() => handleDelete(data.id)}>\n            <Icon>delete</Icon>\n          </IconButton>\n        </Grid>\n        <Grid item xs={2} sm={4} md={3}>\n          <AutoCompleteItem\n            isExternalLoading={isLoading}\n            itemID={data.itemID}\n          />\n        </Grid>\n\n        <Grid item xs={2} sm={4} md={2}>\n          <TextField\n            variant=\"standard\"\n            defaultValue={data.amount}\n            onChange={(e) => setChangedAmount(Number(e.target.value))}\n            onBlur={() => handleSave(data)}\n          />\n        </Grid>\n        <Grid item xs={2} sm={4} md={2}>\n          <TextField\n            variant=\"standard\"\n            defaultValue={data.total}\n            onChange={(e) => setChangedTotal(Number(e.target.value))}\n            onBlur={() => handleSave(data)}\n          />\n        </Grid>\n      </Grid>\n    </VForm>\n  );\n};\n\nexport default TableList;\n"]},"metadata":{},"sourceType":"module"}