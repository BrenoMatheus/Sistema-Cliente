{"ast":null,"code":"import _objectSpread from\"/home/brenomatheus/Documentos/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/brenomatheus/Documentos/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useMemo,useState}from'react';import{Autocomplete,CircularProgress,TextField}from'@mui/material';import{ItemsService}from'../../../../shared/services/api/items/ItemsService';import{useDebounce}from'../../../../shared/hooks';import{useField}from'@unform/core';import{jsx as _jsx}from\"react/jsx-runtime\";export var AutoCompleteItem=function AutoCompleteItem(_ref){var _ref$isExternalLoadin=_ref.isExternalLoading,isExternalLoading=_ref$isExternalLoadin===void 0?false:_ref$isExternalLoadin,itemID=_ref.itemID;var _useField=useField('itemID'),fieldName=_useField.fieldName,registerField=_useField.registerField,defaultValue=_useField.defaultValue,error=_useField.error,clearError=_useField.clearError;var _useDebounce=useDebounce(),debounce=_useDebounce.debounce;var _useState=useState(itemID||defaultValue),_useState2=_slicedToArray(_useState,2),selectedItemId=_useState2[0],setSelectedItemId=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),opcoesItem=_useState4[0],setOpcoesItem=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),buscaItem=_useState8[0],setBuscaItem=_useState8[1];useEffect(function(){registerField({name:fieldName,getValue:function getValue(){return selectedItemId;},setValue:function setValue(_,newSelectedItemID){return setSelectedItemId(newSelectedItemID);}});},[registerField,fieldName,selectedItemId]);useEffect(function(){setIsLoading(true);debounce(function(){ItemsService.getAll(1,buscaItem,selectedItemId).then(function(result){setIsLoading(false);if(result instanceof Error){// alert(result.message);\n}else{setOpcoesItem(result.data.map(function(item){return{id:item.id,label:item.name};}));}});});},[buscaItem,selectedItemId]);var autoCompleteItemSelectedOption=useMemo(function(){if(!selectedItemId)return null;var selectedItemOption=opcoesItem.find(function(opcoesItem){return opcoesItem.id===selectedItemId;});if(!selectedItemOption)return null;return selectedItemOption;},[selectedItemId,opcoesItem]);return/*#__PURE__*/_jsx(Autocomplete,{openText:\"Abrir\",closeText:\"Fechar\",noOptionsText:\"Sem op\\xE7\\xF5es\",loadingText:\"Carregando...\",disablePortal:true,options:opcoesItem,loading:isLoading,disabled:isExternalLoading,value:autoCompleteItemSelectedOption,onInputChange:function onInputChange(_,newValueItem){return setBuscaItem(newValueItem);},onChange:function onChange(_,newValueItem){setSelectedItemId(newValueItem===null||newValueItem===void 0?void 0:newValueItem.id);setBuscaItem('');clearError();},popupIcon:isExternalLoading||isLoading?/*#__PURE__*/_jsx(CircularProgress,{size:28}):undefined,renderInput:function renderInput(paramsItem){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({variant:\"standard\"},paramsItem),{},{error:!!error,helperText:error}));}});};","map":{"version":3,"sources":["/home/brenomatheus/Documentos/frontend/src/pages/orders/components/itemofLines/AutoCompleteItem.tsx"],"names":["useEffect","useMemo","useState","Autocomplete","CircularProgress","TextField","ItemsService","useDebounce","useField","AutoCompleteItem","isExternalLoading","itemID","fieldName","registerField","defaultValue","error","clearError","debounce","selectedItemId","setSelectedItemId","opcoesItem","setOpcoesItem","isLoading","setIsLoading","buscaItem","setBuscaItem","name","getValue","setValue","_","newSelectedItemID","getAll","then","result","Error","data","map","item","id","label","autoCompleteItemSelectedOption","selectedItemOption","find","newValueItem","undefined","paramsItem"],"mappings":"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","sourcesContent":["import { useEffect, useMemo, useState } from 'react';\nimport { Autocomplete, CircularProgress, TextField } from '@mui/material';\n\nimport { ItemsService } from '../../../../shared/services/api/items/ItemsService';\nimport { useDebounce } from '../../../../shared/hooks';\nimport { useField } from '@unform/core';\n\ntype TAutoCompleteItemOption = {\n  id: number;\n  label: string;\n}\n\ninterface IAutoCompleteItemProps {\n  isExternalLoading?: boolean;\n  itemID: number;\n}\nexport const AutoCompleteItem: React.FC<IAutoCompleteItemProps> = ({ isExternalLoading = false, itemID }) => {\n  const { fieldName, registerField, defaultValue, error, clearError } = useField('itemID');\n  const { debounce } = useDebounce();\n\n  const [selectedItemId, setSelectedItemId] = useState<number | undefined>(itemID || defaultValue);\n\n  const [opcoesItem, setOpcoesItem] = useState<TAutoCompleteItemOption[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [buscaItem, setBuscaItem] = useState('');\n\n  useEffect(() => {\n    registerField({\n      name: fieldName,\n      getValue: () => selectedItemId,\n      setValue: (_, newSelectedItemID) => setSelectedItemId(newSelectedItemID),\n    });\n  }, [registerField, fieldName, selectedItemId]);\n\n  useEffect(() => {\n    setIsLoading(true);\n\n    debounce(() => {\n      ItemsService.getAll(1, buscaItem, selectedItemId)\n        .then((result) => {\n          setIsLoading(false);\n\n          if (result instanceof Error) {\n            // alert(result.message);\n          } else {\n            setOpcoesItem(result.data.map(item => ({ id: item.id, label: item.name })));\n          }\n        });\n    });\n  }, [buscaItem, selectedItemId]);\n\n  const autoCompleteItemSelectedOption = useMemo(() => {\n    if (!selectedItemId) return null;\n\n    const selectedItemOption = opcoesItem.find(opcoesItem => opcoesItem.id === selectedItemId);\n    if (!selectedItemOption) return null;\n\n    return selectedItemOption;\n  }, [selectedItemId, opcoesItem]);\n\n  return (\n    <Autocomplete\n      openText='Abrir'\n      closeText='Fechar'\n      noOptionsText='Sem opções'\n      loadingText='Carregando...'\n    \n      disablePortal\n      options={opcoesItem}\n      loading={isLoading}\n      disabled={isExternalLoading}\n      value={autoCompleteItemSelectedOption}\n      onInputChange={(_, newValueItem) => setBuscaItem(newValueItem)}\n      onChange={(_, newValueItem) => { setSelectedItemId(newValueItem?.id); setBuscaItem(''); clearError(); }}\n      popupIcon={(isExternalLoading || isLoading) ? <CircularProgress size={28} /> : undefined}\n      renderInput={(paramsItem) => (\n        <TextField\n          variant=\"standard\"\n          {...paramsItem}\n          error={!!error}\n          helperText={error}\n        />\n      )}\n    />\n  );\n};\n"]},"metadata":{},"sourceType":"module"}