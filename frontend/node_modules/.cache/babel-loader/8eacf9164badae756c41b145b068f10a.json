{"ast":null,"code":"import _objectSpread from\"/home/brenomatheus/Documentos/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/brenomatheus/Documentos/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useMemo,useState}from'react';import{Autocomplete,CircularProgress,TextField}from'@mui/material';import{EquipmentsService}from'../../../shared/services/api/equipments/EquipmentsService';import{useDebounce}from'../../../shared/hooks';import{useField}from'@unform/core';import{jsx as _jsx}from\"react/jsx-runtime\";export var AutoCompleteEquipment=function AutoCompleteEquipment(_ref){var _ref$isExternalLoadin=_ref.isExternalLoading,isExternalLoading=_ref$isExternalLoadin===void 0?false:_ref$isExternalLoadin;var _useField=useField('equipmentID'),fieldName=_useField.fieldName,registerField=_useField.registerField,defaultValue=_useField.defaultValue,error=_useField.error,clearError=_useField.clearError;var _useDebounce=useDebounce(),debounce=_useDebounce.debounce;var _useState=useState(defaultValue),_useState2=_slicedToArray(_useState,2),selectedId=_useState2[0],setSelectedId=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),opcoes=_useState4[0],setOpcoes=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),busca=_useState8[0],setBusca=_useState8[1];useEffect(function(){registerField({name:fieldName,getValue:function getValue(){return selectedId;},setValue:function setValue(_,newSelectedId){return setSelectedId(newSelectedId);}});},[registerField,fieldName,selectedId]);useEffect(function(){setIsLoading(true);debounce(function(){EquipmentsService.getAll(1,busca,selectedId).then(function(result){setIsLoading(false);if(result instanceof Error){// alert(result.message);\n}else{//console.log(result);\nsetOpcoes(result.data.map(function(equipment){return{id:equipment.id,label:equipment.name};}));}});});},[busca,selectedId]);var autoCompleteSelectedOption=useMemo(function(){if(!selectedId)return null;var selectedOption=opcoes.find(function(opcao){return opcao.id===selectedId;});if(!selectedOption)return null;return selectedOption;},[selectedId,opcoes]);return/*#__PURE__*/_jsx(Autocomplete,{openText:\"Abrir\",closeText:\"Fechar\",noOptionsText:\"Sem op\\xE7\\xF5es\",loadingText:\"Carregando...\",disablePortal:true,options:opcoes,loading:isLoading,disabled:isExternalLoading,value:autoCompleteSelectedOption,onInputChange:function onInputChange(_,newValue){return setBusca(newValue);},onChange:function onChange(_,newValue){setSelectedId(newValue===null||newValue===void 0?void 0:newValue.id);setBusca('');clearError();},popupIcon:isExternalLoading||isLoading?/*#__PURE__*/_jsx(CircularProgress,{size:28}):undefined,renderInput:function renderInput(params){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{label:\"Equipamento\",error:!!error,helperText:error}));}});};","map":{"version":3,"sources":["/home/brenomatheus/Documentos/frontend/src/pages/orders/components/AutoCompleteEquipment.tsx"],"names":["useEffect","useMemo","useState","Autocomplete","CircularProgress","TextField","EquipmentsService","useDebounce","useField","AutoCompleteEquipment","isExternalLoading","fieldName","registerField","defaultValue","error","clearError","debounce","selectedId","setSelectedId","opcoes","setOpcoes","isLoading","setIsLoading","busca","setBusca","name","getValue","setValue","_","newSelectedId","getAll","then","result","Error","data","map","equipment","id","label","autoCompleteSelectedOption","selectedOption","find","opcao","newValue","undefined","params"],"mappings":"uPAAA,OAASA,SAAT,CAAoBC,OAApB,CAA6BC,QAA7B,KAA6C,OAA7C,CACA,OAASC,YAAT,CAAuBC,gBAAvB,CAAyCC,SAAzC,KAA0D,eAA1D,CAEA,OAASC,iBAAT,KAAkC,2DAAlC,CACA,OAASC,WAAT,KAA4B,uBAA5B,CACA,OAASC,QAAT,KAAyB,cAAzB,C,2CAWA,MAAO,IAAMC,CAAAA,qBAA4D,CAAG,QAA/DA,CAAAA,qBAA+D,MAAmC,gCAAhCC,iBAAgC,CAAhCA,iBAAgC,gCAAZ,KAAY,uBAC7G,cAAsEF,QAAQ,CAAC,aAAD,CAA9E,CAAQG,SAAR,WAAQA,SAAR,CAAmBC,aAAnB,WAAmBA,aAAnB,CAAkCC,YAAlC,WAAkCA,YAAlC,CAAgDC,KAAhD,WAAgDA,KAAhD,CAAuDC,UAAvD,WAAuDA,UAAvD,CACA,iBAAqBR,WAAW,EAAhC,CAAQS,QAAR,cAAQA,QAAR,CAEA,cAAoCd,QAAQ,CAAqBW,YAArB,CAA5C,wCAAOI,UAAP,eAAmBC,aAAnB,eAEA,eAA4BhB,QAAQ,CAAiC,EAAjC,CAApC,yCAAOiB,MAAP,eAAeC,SAAf,eACA,eAAkClB,QAAQ,CAAC,KAAD,CAA1C,yCAAOmB,SAAP,eAAkBC,YAAlB,eACA,eAA0BpB,QAAQ,CAAC,EAAD,CAAlC,yCAAOqB,KAAP,eAAcC,QAAd,eAEAxB,SAAS,CAAC,UAAM,CACdY,aAAa,CAAC,CACZa,IAAI,CAAEd,SADM,CAEZe,QAAQ,CAAE,0BAAMT,CAAAA,UAAN,EAFE,CAGZU,QAAQ,CAAE,kBAACC,CAAD,CAAIC,aAAJ,QAAsBX,CAAAA,aAAa,CAACW,aAAD,CAAnC,EAHE,CAAD,CAAb,CAKD,CANQ,CAMN,CAACjB,aAAD,CAAgBD,SAAhB,CAA2BM,UAA3B,CANM,CAAT,CAQAjB,SAAS,CAAC,UAAM,CACdsB,YAAY,CAAC,IAAD,CAAZ,CAEAN,QAAQ,CAAC,UAAM,CACbV,iBAAiB,CAACwB,MAAlB,CAAyB,CAAzB,CAA4BP,KAA5B,CAAmCN,UAAnC,EACGc,IADH,CACQ,SAACC,MAAD,CAAY,CAChBV,YAAY,CAAC,KAAD,CAAZ,CAEA,GAAIU,MAAM,WAAYC,CAAAA,KAAtB,CAA6B,CAC3B;AACD,CAFD,IAEO,CACL;AACAb,SAAS,CAACY,MAAM,CAACE,IAAP,CAAYC,GAAZ,CAAgB,SAAAC,SAAS,QAAK,CAAEC,EAAE,CAAED,SAAS,CAACC,EAAhB,CAAoBC,KAAK,CAAEF,SAAS,CAACX,IAArC,CAAL,EAAzB,CAAD,CAAT,CACD,CACF,CAVH,EAWD,CAZO,CAAR,CAaD,CAhBQ,CAgBN,CAACF,KAAD,CAAQN,UAAR,CAhBM,CAAT,CAkBA,GAAMsB,CAAAA,0BAA0B,CAAGtC,OAAO,CAAC,UAAM,CAC/C,GAAI,CAACgB,UAAL,CAAiB,MAAO,KAAP,CAEjB,GAAMuB,CAAAA,cAAc,CAAGrB,MAAM,CAACsB,IAAP,CAAY,SAAAC,KAAK,QAAIA,CAAAA,KAAK,CAACL,EAAN,GAAapB,UAAjB,EAAjB,CAAvB,CACA,GAAI,CAACuB,cAAL,CAAqB,MAAO,KAAP,CAErB,MAAOA,CAAAA,cAAP,CACD,CAPyC,CAOvC,CAACvB,UAAD,CAAaE,MAAb,CAPuC,CAA1C,CAUA,mBACE,KAAC,YAAD,EACE,QAAQ,CAAC,OADX,CAEE,SAAS,CAAC,QAFZ,CAGE,aAAa,CAAC,kBAHhB,CAIE,WAAW,CAAC,eAJd,CAME,aAAa,KANf,CAQE,OAAO,CAAEA,MARX,CASE,OAAO,CAAEE,SATX,CAUE,QAAQ,CAAEX,iBAVZ,CAWE,KAAK,CAAE6B,0BAXT,CAYE,aAAa,CAAE,uBAACX,CAAD,CAAIe,QAAJ,QAAiBnB,CAAAA,QAAQ,CAACmB,QAAD,CAAzB,EAZjB,CAaE,QAAQ,CAAE,kBAACf,CAAD,CAAIe,QAAJ,CAAiB,CAAEzB,aAAa,CAACyB,QAAD,SAACA,QAAD,iBAACA,QAAQ,CAAEN,EAAX,CAAb,CAA6Bb,QAAQ,CAAC,EAAD,CAAR,CAAcT,UAAU,GAAK,CAbzF,CAcE,SAAS,CAAGL,iBAAiB,EAAIW,SAAtB,cAAmC,KAAC,gBAAD,EAAkB,IAAI,CAAE,EAAxB,EAAnC,CAAoEuB,SAdjF,CAeE,WAAW,CAAE,qBAACC,MAAD,qBACX,KAAC,SAAD,gCACMA,MADN,MAGE,KAAK,CAAC,aAHR,CAIE,KAAK,CAAE,CAAC,CAAC/B,KAJX,CAKE,UAAU,CAAEA,KALd,GADW,EAff,EADF,CA2BD,CAzEM","sourcesContent":["import { useEffect, useMemo, useState } from 'react';\nimport { Autocomplete, CircularProgress, TextField } from '@mui/material';\n\nimport { EquipmentsService } from '../../../shared/services/api/equipments/EquipmentsService';\nimport { useDebounce } from '../../../shared/hooks';\nimport { useField } from '@unform/core';\n\n\ntype TAutoCompleteEquipmentOption = {\n  id: number;\n  label: string;\n}\n\ninterface IAutoCompleteEquipmentProps {\n  isExternalLoading?: boolean;\n}\nexport const AutoCompleteEquipment: React.FC<IAutoCompleteEquipmentProps> = ({ isExternalLoading = false }) => {\n  const { fieldName, registerField, defaultValue, error, clearError } = useField('equipmentID');\n  const { debounce } = useDebounce();\n\n  const [selectedId, setSelectedId] = useState<number | undefined>(defaultValue);\n\n  const [opcoes, setOpcoes] = useState<TAutoCompleteEquipmentOption[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [busca, setBusca] = useState('');\n\n  useEffect(() => {\n    registerField({\n      name: fieldName,\n      getValue: () => selectedId,\n      setValue: (_, newSelectedId) => setSelectedId(newSelectedId),\n    });\n  }, [registerField, fieldName, selectedId]);\n\n  useEffect(() => {\n    setIsLoading(true);\n\n    debounce(() => {\n      EquipmentsService.getAll(1, busca, selectedId)\n        .then((result) => {\n          setIsLoading(false);\n\n          if (result instanceof Error) {\n            // alert(result.message);\n          } else {\n            //console.log(result);\n            setOpcoes(result.data.map(equipment => ({ id: equipment.id, label: equipment.name })));\n          }\n        });\n    });\n  }, [busca, selectedId]);\n\n  const autoCompleteSelectedOption = useMemo(() => {\n    if (!selectedId) return null;\n\n    const selectedOption = opcoes.find(opcao => opcao.id === selectedId);\n    if (!selectedOption) return null;\n\n    return selectedOption;\n  }, [selectedId, opcoes]);\n\n\n  return (\n    <Autocomplete\n      openText='Abrir'\n      closeText='Fechar'\n      noOptionsText='Sem opções'\n      loadingText='Carregando...'\n\n      disablePortal\n\n      options={opcoes}\n      loading={isLoading}\n      disabled={isExternalLoading}\n      value={autoCompleteSelectedOption}\n      onInputChange={(_, newValue) => setBusca(newValue)}\n      onChange={(_, newValue) => { setSelectedId(newValue?.id); setBusca(''); clearError(); }}\n      popupIcon={(isExternalLoading || isLoading) ? <CircularProgress size={28} /> : undefined}\n      renderInput={(params) => (\n        <TextField\n          {...params}\n\n          label=\"Equipamento\"\n          error={!!error}\n          helperText={error}\n        />\n      )}\n    />\n  );\n};\n"]},"metadata":{},"sourceType":"module"}