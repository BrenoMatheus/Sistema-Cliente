{"ast":null,"code":"import _objectSpread from\"/home/brenomatheus/Documentos/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/brenomatheus/Documentos/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useMemo,useState}from'react';import{Autocomplete,CircularProgress,TextField}from'@mui/material';import{TechniciansService}from'../../../shared/services/api/technicians/TechniciansService';import{useDebounce}from'../../../shared/hooks';import{useField}from'@unform/core';import{jsx as _jsx}from\"react/jsx-runtime\";export var AutoCompleteTechnician=function AutoCompleteTechnician(_ref){var _ref$isExternalLoadin=_ref.isExternalLoading,isExternalLoading=_ref$isExternalLoadin===void 0?false:_ref$isExternalLoadin;var _useField=useField('technicianID'),fieldName=_useField.fieldName,registerField=_useField.registerField,defaultValue=_useField.defaultValue,error=_useField.error,clearError=_useField.clearError;var _useDebounce=useDebounce(),debounce=_useDebounce.debounce;var _useState=useState(defaultValue),_useState2=_slicedToArray(_useState,2),selectedTechnicianId=_useState2[0],setSelectedTechnicianId=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),opcoesTechnician=_useState4[0],setOpcoesTechnician=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),buscaTechnician=_useState8[0],setBuscaTechnician=_useState8[1];useEffect(function(){registerField({name:fieldName,getValue:function getValue(){return selectedTechnicianId;},setValue:function setValue(_,newSelectedTechnicianID){return setSelectedTechnicianId(newSelectedTechnicianID);}});},[registerField,fieldName,selectedTechnicianId]);useEffect(function(){setIsLoading(true);debounce(function(){TechniciansService.getAll(1,buscaTechnician,selectedTechnicianId).then(function(result){setIsLoading(false);if(result instanceof Error){// alert(result.message);\n}else{setOpcoesTechnician(result.data.map(function(technician){return{id:technician.id,label:technician.name};}));}});});},[buscaTechnician,selectedTechnicianId]);var autoCompleteTechnicianSelectedOption=useMemo(function(){if(!selectedTechnicianId)return null;var selectedTechnicianOption=opcoesTechnician.find(function(opcoesTechnician){return opcoesTechnician.id===selectedTechnicianId;});if(!selectedTechnicianOption)return null;return selectedTechnicianOption;},[selectedTechnicianId,opcoesTechnician]);return/*#__PURE__*/_jsx(Autocomplete,{openText:\"Abrir\",closeText:\"Fechar\",noOptionsText:\"Sem op\\xE7\\xF5es\",loadingText:\"Carregando...\",disablePortal:true,options:opcoesTechnician,loading:isLoading,disabled:isExternalLoading,value:autoCompleteTechnicianSelectedOption,onInputChange:function onInputChange(_,newValueTechnician){return setBuscaTechnician(newValueTechnician);},onChange:function onChange(_,newValueTechnician){setSelectedTechnicianId(newValueTechnician===null||newValueTechnician===void 0?void 0:newValueTechnician.id);setBuscaTechnician('');clearError();},popupIcon:isExternalLoading||isLoading?/*#__PURE__*/_jsx(CircularProgress,{size:28}):undefined,renderInput:function renderInput(paramsTechnician){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},paramsTechnician),{},{label:\"T\\xE9cnico\",error:!!error,helperText:error}));}});};","map":{"version":3,"sources":["/home/brenomatheus/Documentos/frontend/src/pages/orders/components/AutoCompleteTechnician.tsx"],"names":["useEffect","useMemo","useState","Autocomplete","CircularProgress","TextField","TechniciansService","useDebounce","useField","AutoCompleteTechnician","isExternalLoading","fieldName","registerField","defaultValue","error","clearError","debounce","selectedTechnicianId","setSelectedTechnicianId","opcoesTechnician","setOpcoesTechnician","isLoading","setIsLoading","buscaTechnician","setBuscaTechnician","name","getValue","setValue","_","newSelectedTechnicianID","getAll","then","result","Error","data","map","technician","id","label","autoCompleteTechnicianSelectedOption","selectedTechnicianOption","find","newValueTechnician","undefined","paramsTechnician"],"mappings":"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","sourcesContent":["import { useEffect, useMemo, useState } from 'react';\nimport { Autocomplete, CircularProgress, TextField } from '@mui/material';\n\nimport { TechniciansService } from '../../../shared/services/api/technicians/TechniciansService';\nimport { useDebounce } from '../../../shared/hooks';\nimport { useField } from '@unform/core';\n\n\ntype TAutoCompleteTechnicianOption = {\n  id: number;\n  label: string;\n}\n\ninterface IAutoCompleteTechnicianProps {\n  isExternalLoading?: boolean;\n}\nexport const AutoCompleteTechnician: React.FC<IAutoCompleteTechnicianProps> = ({ isExternalLoading = false }) => {\n  const { fieldName, registerField, defaultValue, error, clearError } = useField('technicianID');\n  const { debounce } = useDebounce();\n\n  const [selectedTechnicianId, setSelectedTechnicianId] = useState<number | undefined>(defaultValue);\n\n  const [opcoesTechnician, setOpcoesTechnician] = useState<TAutoCompleteTechnicianOption[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [buscaTechnician, setBuscaTechnician] = useState('');\n\n  useEffect(() => {\n    registerField({\n      name: fieldName,\n      getValue: () => selectedTechnicianId,\n      setValue: (_, newSelectedTechnicianID) => setSelectedTechnicianId(newSelectedTechnicianID),\n    });\n  }, [registerField, fieldName, selectedTechnicianId]);\n\n  useEffect(() => {\n    setIsLoading(true);\n\n    debounce(() => {\n      TechniciansService.getAll(1, buscaTechnician, selectedTechnicianId)\n        .then((result) => {\n          setIsLoading(false);\n\n          if (result instanceof Error) {\n            // alert(result.message);\n          } else {\n            setOpcoesTechnician(result.data.map(technician => ({ id: technician.id, label: technician.name })));\n          }\n        });\n    });\n  }, [buscaTechnician, selectedTechnicianId]);\n\n  const autoCompleteTechnicianSelectedOption = useMemo(() => {\n    if (!selectedTechnicianId) return null;\n\n    const selectedTechnicianOption = opcoesTechnician.find(opcoesTechnician => opcoesTechnician.id === selectedTechnicianId);\n    if (!selectedTechnicianOption) return null;\n\n    return selectedTechnicianOption;\n  }, [selectedTechnicianId, opcoesTechnician]);\n\n\n  return (\n    <Autocomplete\n      openText='Abrir'\n      closeText='Fechar'\n      noOptionsText='Sem opções'\n      loadingText='Carregando...'\n    \n      disablePortal\n      options={opcoesTechnician}\n      loading={isLoading}\n      disabled={isExternalLoading}\n      value={autoCompleteTechnicianSelectedOption}\n      onInputChange={(_, newValueTechnician) => setBuscaTechnician(newValueTechnician)}\n      onChange={(_, newValueTechnician) => { setSelectedTechnicianId(newValueTechnician?.id); setBuscaTechnician(''); clearError(); }}\n      popupIcon={(isExternalLoading || isLoading) ? <CircularProgress size={28} /> : undefined}\n      renderInput={(paramsTechnician) => (\n        <TextField\n          {...paramsTechnician}\n          label=\"Técnico\"\n          error={!!error}\n          helperText={error}\n        />\n      )}\n    />\n  );\n};\n"]},"metadata":{},"sourceType":"module"}